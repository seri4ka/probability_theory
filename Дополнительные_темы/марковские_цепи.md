# Марковские цепи

**Марковская цепь** — это случайный процесс, который описывает последовательность событий, в которой вероятность перехода в следующее состояние зависит только от текущего состояния и не зависит от предыдущих состояний. Этот принцип называется **свойством Маркова** и позволяет моделировать процессы, где будущие состояния зависят исключительно от текущего состояния системы.

## Основные понятия

1. **Состояния**: Множество возможных состояний системы, через которые она может переходить. Обозначается как \( S = \{s_1, s_2, \dots, s_n\} \).

2. **Переходные вероятности**: Вероятности перехода из одного состояния в другое. Переходная вероятность из состояния \( s_i \) в состояние \( s_j \) обозначается как \( P_{ij} = P(X_{t+1} = s_j | X_t = s_i) \).

3. **Матрица переходных вероятностей**: Матрица \( P \), где каждый элемент \( P_{ij} \) представляет вероятность перехода из состояния \( s_i \) в состояние \( s_j \). Все элементы строки матрицы переходных вероятностей должны в сумме давать 1, так как вероятность перехода из одного состояния в любое другое должна быть полной:
   \[
   P = 
   \begin{pmatrix}
   P_{11} & P_{12} & \dots & P_{1n} \\
   P_{21} & P_{22} & \dots & P_{2n} \\
   \vdots & \vdots & \ddots & \vdots \\
   P_{n1} & P_{n2} & \dots & P_{nn}
   \end{pmatrix}
   \]

4. **Начальное распределение**: Вектор вероятностей \( \pi = (\pi_1, \pi_2, \dots, \pi_n) \), где \( \pi_i \) — вероятность того, что система начнет в состоянии \( s_i \). Сумма всех вероятностей начального распределения должна равняться 1: \( \sum_{i} \pi_i = 1 \).

## Свойства марковских цепей

1. **Стационарное распределение**: Распределение вероятностей, при котором система остаётся в равновесии, то есть вероятность нахождения в каждом состоянии со временем стабилизируется. Вектор \( \pi \) называется стационарным распределением, если он удовлетворяет уравнению:
   \[
   \pi P = \pi
   \]
   где \( \pi \) — вектор стационарного распределения.

2. **Эргодичность**: Марковская цепь называется эргодической, если она обладает свойствами непрерывности и апериодичности, а также возможность перехода из любого состояния в любое другое с ненулевой вероятностью. Эргодичность означает, что цепь со временем приходит к стационарному распределению, независимо от начального состояния.

3. **Классификация состояний**:
   - **Достижимое состояние**: Состояние \( s_j \) называется достижимым из состояния \( s_i \), если существует ненулевая вероятность, что система перейдет из \( s_i \) в \( s_j \).
   - **Поглощающее состояние**: Состояние, в которое система может перейти и остаться в нём навсегда.
   - **Рекуррентное состояние**: Состояние, в которое система обязательно вернётся с вероятностью 1.
   - **Транзитивное состояние**: Состояние, которое может не повториться с вероятностью больше 0.

## Пример марковской цепи

Рассмотрим систему погоды, которая может находиться в двух состояниях: "солнечно" (S) и "дождливо" (D). Пусть вероятность того, что день будет солнечным после солнечного дня, составляет 0.8, а после дождливого дня — 0.4. Пусть также вероятность дождливого дня после солнечного — 0.2, а после дождливого — 0.6.

### Матрица переходных вероятностей

Состояния системы: \( S = \{\text{солнечно}, \text{дождливо}\} \).

Матрица переходных вероятностей:
\[
P = 
\begin{pmatrix}
0.8 & 0.2 \\
0.4 & 0.6 
\end{pmatrix}
\]

### Расчёт вероятности состояния через несколько дней

Если известно начальное состояние погоды \( \pi = (1, 0) \) (то есть первый день солнечный), вероятность каждого состояния на второй день можно найти, умножив начальное распределение на матрицу переходных вероятностей:
\[
\pi^{(2)} = \pi^{(1)} \cdot P = (1, 0) \cdot 
\begin{pmatrix}
0.8 & 0.2 \\
0.4 & 0.6 
\end{pmatrix} = (0.8, 0.2)
\]
Это означает, что на второй день вероятность солнечной погоды составляет 80%, а дождливой — 20%.

## Применение марковских цепей

Марковские цепи применяются в широком диапазоне областей, включая:

1. **Моделирование очередей и потоков клиентов**: Определение вероятностей переходов между состояниями клиентов (например, ожидание, обслуживание, завершение).

2. **Финансовые рынки**: Анализ состояний рынка, таких как рост, падение или стагнация, на основе предыдущих состояний.

3. **Генерация текста**: Использование марковских цепей для прогнозирования последовательности слов и предложений на основе предыдущих слов.

4. **Обработка сигналов и управление**: Моделирование вероятностных переходов в динамических системах.

5. **Анализ биологических последовательностей**: Использование марковских цепей для предсказания структурных элементов в последовательностях ДНК или белков.

## Заключение

Марковские цепи — это мощный инструмент для моделирования процессов, где будущее состояние зависит только от текущего. Они широко применяются в науке, технике и бизнесе для прогнозирования и анализа различных систем. Благодаря своим математическим свойствам марковские цепи позволяют строить модели для сложных последовательностей событий, предоставляя ценные аналитические инструменты.
